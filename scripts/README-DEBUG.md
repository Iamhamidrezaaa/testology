# ุฑุงูููุง ุงุณุชูุงุฏู ุงุฒ ููุฏ Debug ุจุฑุง ุชุณุชโูุง

## ๐ ุฎูุงุตู

ุงู ุณุณุชู ุจู ุดูุง ุงูฺฉุงู ูโุฏูุฏ ุฌุฒุฆุงุช ฺฉุงูู ููุฑูโุฏู ุชุณุชโูุง ุฑุง ุจุจูุฏ:
- ููุฏุงุฑ ุฎุงู ูุฑ ุณูุงู (raw)
- ุงุนูุงู reverse scoring (ุงฺฏุฑ ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏ)
- ูุฒู ูุฑ ุณูุงู (weight)
- ููุฑู ููุง ูุฑ ุณูุงู (weighted)
- ููุฑู ุฒุฑููุงุณโูุง
- ููุฑู ฺฉู ู ุณุทุญ

## ๐ง ูุญูู ุงุณุชูุงุฏู

### 1. ุงุณุชูุงุฏู ุงุฒ API ุจุง ููุฏ Debug

ุจุฑุง ูุนุงู ฺฉุฑุฏู ููุฏ debugุ ููุท `?debug=1` ุฑุง ุจู URL ุงุถุงูู ฺฉูุฏ:

```bash
POST http://localhost:3000/api/tests/gad7/submit?debug=1
Content-Type: application/json

{
  "answers": [
    { "questionId": 1, "value": 0 },
    { "questionId": 2, "value": 1 },
    { "questionId": 3, "value": 2 },
    { "questionId": 4, "value": 3 },
    { "questionId": 5, "value": 0 },
    { "questionId": 6, "value": 1 },
    { "questionId": 7, "value": 2 }
  ],
  "email": "test@example.com"
}
```

### 2. ูพุงุณุฎ Debug

ูพุงุณุฎ ุดุงูู ฺฉ ููุฏ `debug` ุงุณุช ฺฉู ุดุงูู:

```json
{
  "success": true,
  "saved": true,
  "result": {
    "testId": "GAD7",
    "totalScore": 9,
    "totalLevelLabel": "ุงุถุทุฑุงุจ ุฎูู",
    ...
  },
  "debug": {
    "testId": "GAD7",
    "config": {
      "scaleMin": 0,
      "scaleMax": 3,
      "scoringType": "sum",
      "reverseItems": []
    },
    "items": [
      {
        "questionId": 1,
        "text": "ุฏุฑ ฒ ููุชู ุงุฎุฑ ฺูุฏุฑ ูฺฏุฑุงู ุจูุฏูโุงุฏุ",
        "raw": 0,
        "reverse": false,
        "normalized": 0,
        "weight": 1,
        "weighted": 0,
        "subscale": "anxiety"
      },
      ...
    ],
    "subscales": [
      {
        "id": "anxiety",
        "label": "ุณุทุญ ฺฉู ุงุถุทุฑุงุจ",
        "items": [1, 2, 3, 4, 5, 6, 7],
        "score": 9
      }
    ],
    "totalScore": 9,
    "totalLevelId": "mild",
    "totalLevelLabel": "ุงุถุทุฑุงุจ ุฎูู"
  }
}
```

### 3. ุงุณุชูุงุฏู ุงุฒ ุงุณฺฉุฑูพุช ุชุณุช ุฎูุฏฺฉุงุฑ

ุจุฑุง ุงุฌุฑุง ฺูุฏ ุณูุงุฑู ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ:

```bash
# ูุทูุฆู ุดูุฏ ฺฉู ุณุฑูุฑ ุฏุฑ ุญุงู ุงุฌุฑุง ุงุณุช
npm run dev

# ุฏุฑ ุชุฑููุงู ุฏฺฏุฑ
npx ts-node scripts/debug-gad7.ts
```

ุง ุงฺฏุฑ `ts-node` ูุตุจ ูุณุช:

```bash
node --loader ts-node/esm scripts/debug-gad7.ts
```

## ๐ ุชูุณุฑ ูุชุงุฌ Debug

### ููุฏูุง ูุฑ ุณูุงู (items):

- **questionId**: ุดูุงุฑู ุณูุงู
- **text**: ูุชู ุณูุงู (ุงฺฏุฑ ููุฌูุฏ ุจุงุดุฏ)
- **raw**: ููุฏุงุฑ ุฎุงู ฺฉู ุงุฒ UI ุขูุฏู (0-3 ุจุฑุง GAD-7)
- **reverse**: ุขุง ุงู ุณูุงู reverse-scored ุงุณุชุ
- **normalized**: ููุฏุงุฑ ุจุนุฏ ุงุฒ ุงุนูุงู reverse (ุงฺฏุฑ ูุงุฒู ุจุงุดุฏ)
- **weight**: ูุฒู ุณูุงู (ูุนูุงู ููู 1 ูุณุชูุฏ)
- **weighted**: ููุฑู ููุง ุณูุงู (normalized ร weight)
- **subscale**: ุฒุฑููุงุณ ูุฑุจูุทู

### ูุซุงู:

ุจุฑุง GAD-7:
- ุงฺฏุฑ ุณูุงู 1 ุจุง `raw: 3` ู `reverse: false` ุจุงุดุฏ:
  - `normalized = 3`
  - `weighted = 3 ร 1 = 3`
- ุงฺฏุฑ ุณูุงู ุจุง `raw: 3` ู `reverse: true` ุจุงุดุฏ (ูุซูุงู ุฏุฑ ุชุณุชโูุง ุฏฺฏุฑ):
  - `normalized = scaleMin + scaleMax - raw = 0 + 3 - 3 = 0`
  - `weighted = 0 ร 1 = 0`

## โ ุจุฑุฑุณ ุตุญุช ููุฑูโุฏู

ุจุง ุงุณุชูุงุฏู ุงุฒ debug ูโุชูุงูุฏ:

1. **ุจุฑุฑุณ reverse scoring**: ูุทูุฆู ุดูุฏ ฺฉู ุณูุงูโูุง reverse ุฏุฑุณุช ูุนฺฉูุณ ูโุดููุฏ
2. **ุจุฑุฑุณ ูุฒูโูุง**: ุงฺฏุฑ ูุฒูโูุง ูุชูุงูุช ุฏุงุฑุฏุ ูุทูุฆู ุดูุฏ ฺฉู ุฏุฑุณุช ุงุนูุงู ูโุดููุฏ
3. **ุจุฑุฑุณ ุฒุฑููุงุณโูุง**: ุจุจูุฏ ฺฉู ูุฑ ุณูุงู ุจู ุฒุฑููุงุณ ุฏุฑุณุช ุงุถุงูู ูโุดูุฏ
4. **ุจุฑุฑุณ ููุฑู ฺฉู**: ุฌูุน weighted values ุจุงุฏ ุจุง totalScore ูุทุงุจูุช ุฏุงุดุชู ุจุงุดุฏ

## ๐ ุชุณุชโูุง ูพุดุชุจุงู ุดุฏู

ุงู ุณุณุชู ุจุฑุง ุชูุงู ุชุณุชโูุง ฺฉู ุงุฒ `scoring-engine-v2` ุงุณุชูุงุฏู ูโฺฉููุฏ ฺฉุงุฑ ูโฺฉูุฏ:

- GAD-7 (ุงุถุทุฑุงุจ)
- PHQ-9 (ุงูุณุฑุฏฺฏ)
- MBTI (ุดุฎุตุช)
- RIASEC (ุดุบู)
- Attachment (ุฏูุจุณุชฺฏ)
- ู ุจูู...

## ๐ ูฺฉุงุช

- ููุฏ debug ููุท ุฏุฑ development ุชูุตู ูโุดูุฏ
- ุฏุฑ productionุ debug info ุฑุง ุจุฑฺฏุฑุฏุงู ูฺฉูุฏ (ุงููุช)
- ูุงฺฏโูุง debug ุฏุฑ console ุณุฑูุฑ ูู ููุงุด ุฏุงุฏู ูโุดููุฏ

