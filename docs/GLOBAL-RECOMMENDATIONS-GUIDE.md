# ุฑุงูููุง ุณุณุชู ูพุดููุงุฏ ุชุณุชโูุง ุชฺฉูู ุฏุฑ ุณุทุญ ูพุฑููุงู ฺฉู

ุงู ุณุณุชู ุจุฑ ุงุณุงุณ ุชูุงู ุชุณุชโูุง ุงูุฌุงูโุดุฏู ฺฉุงุฑุจุฑุ ุชุณุชโูุง ุจุนุฏ ุฑุง ูพุดููุงุฏ ูโุฏูุฏ.

## ๐ ุณุงุฎุชุงุฑ ฺฉู

### 1. ูุงู ููุทู (`lib/recommendation/global.ts`)

ุชุงุจุน ุงุตู: `buildGlobalRecommendations(results: TestResult[], limit: number = 6)`

ุงู ุชุงุจุน:
- ุชูุงู TestResultูุง ฺฉุงุฑุจุฑ ุฑุง ูโฺฏุฑุฏ
- ุจุฑ ุงุณุงุณ ุชูพโูุง ุดุฎุตุช (MBTI, RIASEC, Attachment, LearningStyle) ูพุดููุงุฏ ูโุฏูุฏ
- ุจุฑ ุงุณุงุณ ุดุฏุช ุนูุงุฆู (GAD7, PHQ9, PSS10) ูพุดููุงุฏ ูโุฏูุฏ
- ููุงูู ุชุฑฺฉุจ (ูุซูุงู ุงฺฏุฑ ุชุณุชโูุง ุณูุงูุช ุฑูุงู ุฒุงุฏ ุฒุฏู ูู Lifestyle ูุฒุฏู)
- ุชุณุชโูุง ุชฺฉุฑุงุฑ ุฑุง ุญุฐู ูโฺฉูุฏ ู ุงูููุชโุจูุฏ ูโฺฉูุฏ

### 2. API Endpoint (`app/api/dashboard/recommendations/route.ts`)

**GET** `/api/dashboard/recommendations?userId=xxx`

**Response:**
```json
{
  "items": [
    {
      "testId": "Values",
      "reason": "ุจุฑุง ุดูุงูโฺฉุฑุฏู ุณุณุชู ุงุฑุฒุด ู ูุฏูโูุง ุนูู ุฒูุฏฺฏ.",
      "source": "MBTI (INTJ)",
      "priority": 10
    },
    {
      "testId": "PSS10",
      "reason": "ุณุทุญ ุงุถุทุฑุงุจ ุฏุฑ ุชุณุช GAD-7 ุฏุฑ ูุญุฏูุฏูโ ูุชูุณุท ุง ุดุฏุฏ ุจูุฏู...",
      "source": "GAD7",
      "priority": 5
    }
  ]
}
```

### 3. ฺฉุงููพูููุช UI (`components/dashboard/NextStepsRecommendations.tsx`)

ฺฉุงููพูููุช React ฺฉู:
- userId ุฑุง ูโฺฏุฑุฏ
- ุงุฒ API ูพุดููุงุฏูุง ุฑุง ูโฺฏุฑุฏ
- ุจู ุตูุฑุช ุฒุจุง ููุงุด ูโุฏูุฏ
- ููฺฉ ุจู ุชุณุชโูุง ูพุดููุงุฏ ูโุฏูุฏ

## ๐ง ูุญูู ุงุณุชูุงุฏู

### ุฏุฑ ุฏุงุดุจูุฑุฏ:

```tsx
import NextStepsRecommendations from '@/components/dashboard/NextStepsRecommendations';

export default function DashboardPage() {
  const userId = "user123"; // ุง ุงุฒ session ุจฺฏุฑ

  return (
    <div>
      {/* ุจูู ุฏุงุดุจูุฑุฏ */}
      
      <NextStepsRecommendations userId={userId} />
    </div>
  );
}
```

### ุงุณุชูุงุฏู ูุณุชูู ุงุฒ API:

```typescript
const res = await fetch(`/api/dashboard/recommendations?userId=${userId}`);
const data = await res.json();
console.log(data.items); // ูุณุช ูพุดููุงุฏูุง
```

## ๐ ููุงูู ูพุดููุงุฏ

### 1. ููุงูู ุชูพโูุญูุฑ

#### MBTI
- ุงฺฏุฑ ฺฉุงุฑุจุฑ ุชุณุช MBTI ุฒุฏู ุจุงุดุฏ
- ุชูพุด ุงุณุชุฎุฑุงุฌ ูโุดูุฏ (ูุซูุงู INTJ)
- ูพุดููุงุฏูุง ูุฎุตูุต ุขู ุชูพ ุงุฒ `MBTI_RECOMMENDATIONS` ฺฏุฑูุชู ูโุดูุฏ
- ููุท ุชุณุชโูุง ฺฉู ฺฉุงุฑุจุฑ ูููุฒ ูุฒุฏู ูพุดููุงุฏ ูโุดููุฏ

#### RIASEC
- ุงฺฏุฑ ฺฉุงุฑุจุฑ ุชุณุช RIASEC ุฒุฏู ุจุงุดุฏ
- ุชูพ ุบุงูุจ (ูุซูุงู "A" ุจุฑุง Artistic) ุงุณุชุฎุฑุงุฌ ูโุดูุฏ
- ูพุดููุงุฏูุง ูุฎุตูุต ุขู ุชูพ ุงุฒ `RIASEC_RECOMMENDATIONS` ฺฏุฑูุชู ูโุดูุฏ

#### Attachment
- ุงฺฏุฑ ฺฉุงุฑุจุฑ ุชุณุช Attachment ุฒุฏู ุจุงุดุฏ
- ุณุจฺฉ ุบุงูุจ (secure, anxious, avoidant, fearful) ุงุณุชุฎุฑุงุฌ ูโุดูุฏ
- ูพุดููุงุฏูุง ูุฎุตูุต ุขู ุณุจฺฉ ุงุฒ `ATTACHMENT_RECOMMENDATIONS` ฺฏุฑูุชู ูโุดูุฏ

#### LearningStyle
- ุงฺฏุฑ ฺฉุงุฑุจุฑ ุชุณุช LearningStyle ุฒุฏู ุจุงุดุฏ
- ุณุจฺฉ ุบุงูุจ (visual, auditory, kinesthetic, reading_writing) ุงุณุชุฎุฑุงุฌ ูโุดูุฏ
- ูพุดููุงุฏูุง ูุฎุตูุต ุขู ุณุจฺฉ ุงุฒ `LEARNING_STYLE_RECOMMENDATIONS` ฺฏุฑูุชู ูโุดูุฏ

### 2. ููุงูู ุดุฏุช ุนูุงุฆู

#### GAD7 (ุงุถุทุฑุงุจ)
- ุงฺฏุฑ ููุฑู >= 10 (moderate ุง severe)
- ู ฺฉุงุฑุจุฑ ุชุณุช PSS10 ูุฒุฏู ุจุงุดุฏ
- โ ูพุดููุงุฏ PSS10 ุจุง priority 5

#### PHQ9 (ุงูุณุฑุฏฺฏ)
- ุงฺฏุฑ ููุฑู >= 10 (moderate, moderately_severe ุง severe)
- ู ฺฉุงุฑุจุฑ ุชุณุช SWLS ูุฒุฏู ุจุงุดุฏ
- โ ูพุดููุงุฏ SWLS ุจุง priority 6

#### PSS10 (ุงุณุชุฑุณ)
- ุงฺฏุฑ ููุฑู >= 27 (ุงุณุชุฑุณ ุจุงูุง)
- ู ฺฉุงุฑุจุฑ ุชุณุช WorkLifeBalance ูุฒุฏู ุจุงุดุฏ
- โ ูพุดููุงุฏ WorkLifeBalance ุจุง priority 7

#### PSQI (ุฎูุงุจ)
- ุงฺฏุฑ ููุฑู >= 8 (ฺฉูุช ุฎูุงุจ ูพุงู)
- ู ฺฉุงุฑุจุฑ ุชุณุช LifestyleHarmony ูุฒุฏู ุจุงุดุฏ
- โ ูพุดููุงุฏ LifestyleHarmony ุจุง priority 8

### 3. ููุงูู ุชุฑฺฉุจ

#### Mental Health vs Lifestyle
- ุงฺฏุฑ ฺฉุงุฑุจุฑ 2+ ุชุณุช ุณูุงูุช ุฑูุงู ุฒุฏู ุจุงุดุฏ (GAD7, PHQ9, HADS, BAI, DepressionBDI, PSS10)
- ู ูฺ ุชุณุช Lifestyle ูุฒุฏู ุจุงุดุฏ (LifestyleHarmony, PSQI, LifestyleSleepQuality, PhysicalActivity, WorkLifeBalance)
- โ ูพุดููุงุฏ LifestyleHarmony ุจุง priority 15

## ๐ฏ ุงูููุชโุจูุฏ

ูุฑ ูพุดููุงุฏ ฺฉ `priority` ุฏุงุฑุฏ:
- **ฺฉูุชุฑ = ูููโุชุฑ**
- Priority 5-8: ููุงูู ุดุฏุช ุนูุงุฆู (ุจุณุงุฑ ููู)
- Priority 10-19: ููุงูู ุชูพโูุญูุฑ (ููู)
- Priority 20+: ููุงูู ุชุฑฺฉุจ (ูุชูุณุท)

ูพุดููุงุฏูุง ุจุฑ ุงุณุงุณ priority ูุฑุชุจ ูโุดููุฏ ู ุชุง `limit` (ูพุดโูุฑุถ 6) ุจุฑฺฏุฑุฏุงูุฏู ูโุดููุฏ.

## ๐ ุฐุฎุฑูโุณุงุฒ

**ููู:** ุงู ุณุณุชู ูฺ ฺุฒ ุฌุฏุฏ ุฏุฑ DB ุฐุฎุฑู ููโฺฉูุฏ!

- ููุท ุงุฒ TestResultูุง ููุฌูุฏ ุงุณุชูุงุฏู ูโฺฉูุฏ
- subscales ุฏุฑ TestResult ุฐุฎุฑู ูโุดูุฏ (ุฏุฑ submit route)
- interpretation ุฏุฑ TestResult ุฐุฎุฑู ูโุดูุฏ
- ููู ฺุฒ ุงุฒ ููู ุฏุงุฏูโูุง ูุญุงุณุจู ูโุดูุฏ

## ๐ ูุซุงู ุฎุฑูุฌ

ุจุฑุง ฺฉุงุฑุจุฑ ฺฉู:
- MBTI: INTJ
- GAD7: 12 (moderate)
- PHQ9: 8 (mild)
- ุชุณุชโูุง Lifestyle ูุฒุฏู

ุฎุฑูุฌ:
```json
{
  "items": [
    {
      "testId": "PSS10",
      "reason": "ุณุทุญ ุงุถุทุฑุงุจ ุฏุฑ ุชุณุช GAD-7...",
      "source": "GAD7",
      "priority": 5
    },
    {
      "testId": "Values",
      "reason": "ุจุฑุง ุดูุงูโฺฉุฑุฏู ุณุณุชู ุงุฑุฒุด...",
      "source": "MBTI (INTJ)",
      "priority": 10
    },
    {
      "testId": "LifestyleHarmony",
      "reason": "ุชุง ุงูุงู ุจุดุชุฑ ุฑู ุณูุงูุช ุฑูุงู...",
      "source": "Cross: Mental vs Lifestyle",
      "priority": 15
    }
  ]
}
```

## ๐ ุชูุณุนู

ุจุฑุง ุงูุฒูุฏู ูุงููู ุฌุฏุฏ:

1. ุฏุฑ `buildGlobalRecommendations` ฺฉ ุจุฎุด ุฌุฏุฏ ุงุถุงูู ฺฉู
2. ุงุฒ `findLatestResult` ุจุฑุง ูพุฏุง ฺฉุฑุฏู ุชุณุช ุฎุงุต ุงุณุชูุงุฏู ฺฉู
3. ุงุฒ `hasTest` ุจุฑุง ฺฺฉ ฺฉุฑุฏู ุงูฺฉู ฺฉุงุฑุจุฑ ุชุณุช ุฑุง ุฒุฏู ุง ูู
4. ูพุดููุงุฏ ุฑุง ุจุง priority ููุงุณุจ ุงุถุงูู ฺฉู

ูุซุงู:
```typescript
// น) ูุงููู ุฌุฏุฏ: ุงฺฏุฑ X ู Y ุฒุฏู ูู Z ูุฒุฏู
const xResult = findLatestResult(results, "X");
const yResult = findLatestResult(results, "Y");

if (xResult && yResult && !hasTest(results, "Z")) {
  recommendations.push({
    testId: "Z",
    reason: "ุชูุถุญ...",
    source: "Cross: X + Y",
    priority: 25,
  });
}
```

## โ ูฺฉุงุช ููู

1. **ุจุฏูู ุฐุฎุฑูโุณุงุฒ ุงุถุงู**: ููู ฺุฒ ุงุฒ TestResultูุง ููุฌูุฏ ูุญุงุณุจู ูโุดูุฏ
2. **Real-time**: ูุฑ ุจุงุฑ ฺฉู API ุตุฏุง ุฒุฏู ูโุดูุฏุ ูพุดููุงุฏูุง ุฏูุจุงุฑู ูุญุงุณุจู ูโุดููุฏ
3. **ูุงุจู ฺฏุณุชุฑุด**: ุงูุฒูุฏู ูุงููู ุฌุฏุฏ ุจุณุงุฑ ุณุงุฏู ุงุณุช
4. **Performance**: ููุท ฺฉ query ุจู DB (findMany TestResult)

ููู ฺุฒ ุขูุงุฏู ุงุณุช! ๐

