import { Question } from '@/types/test'
import { normalizeQuestions } from '@/lib/helpers/question-helper'

// فقط فیلدهای خام هر سؤال
type RawQuestion = Pick<Question, 'text' | 'options'>


const rawQuestions: RawQuestion[] = [
  {
    text: "من فردی خوش‌برخورد و دوستانه هستم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من فردی منظم و دقیق هستم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من اغلب نگران و مضطرب هستم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من فردی خلاق و هنری هستم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من فردی مهربان و دلسوز هستم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من دوست دارم با افراد جدید آشنا شوم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من کارهایم را به موقع انجام می‌دهم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من اغلب احساس تنش و استرس می‌کنم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من ایده‌های جدید و نوآورانه دارم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من به دیگران کمک می‌کنم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من در مهمانی‌ها و جمع‌ها راحت هستم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من کارهایم را با دقت انجام می‌دهم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من اغلب نگران آینده هستم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من از هنر و زیبایی لذت می‌برم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من به احساسات دیگران توجه می‌کنم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من رهبری گروه‌ها را به عهده می‌گیرم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من برنامه‌هایم را به دقت دنبال می‌کنم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من به راحتی ناراحت می‌شوم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من از تجربه‌های جدید لذت می‌برم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من به دیگران اعتماد می‌کنم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من در گفتگو با دیگران راحت هستم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من کارهایم را منظم انجام می‌دهم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من اغلب احساس غم و افسردگی می‌کنم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من از مطالعه و یادگیری لذت می‌برم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من به دیگران احترام می‌گذارم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من دوست دارم در مرکز توجه باشم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من کارهایم را به موقع تمام می‌کنم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من به راحتی عصبانی می‌شوم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من از حل مسائل پیچیده لذت می‌برم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من با دیگران همکاری می‌کنم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من دوست دارم با افراد زیادی صحبت کنم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من کارهایم را با نظم انجام می‌دهم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من اغلب احساس نگرانی می‌کنم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من از هنر و موسیقی لذت می‌برم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من به دیگران کمک می‌کنم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من در جمع‌ها فعال هستم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من کارهایم را با دقت انجام می‌دهم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من به راحتی ناراحت می‌شوم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من از تجربه‌های جدید لذت می‌برم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من به دیگران اعتماد می‌کنم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من در گفتگو با دیگران راحت هستم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من کارهایم را منظم انجام می‌دهم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من اغلب احساس غم و افسردگی می‌کنم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من از مطالعه و یادگیری لذت می‌برم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  },
  {
    text: "من به دیگران احترام می‌گذارم",
    options: [
      "کاملاً مخالفم",
      "مخالفم",
      "نظری ندارم",
      "موافقم",
      "کاملاً موافقم"
    ]
  }
]



// خروجی نهایی با فیلدهای اجباری تکمیل می‌شود
export const bfiQuestions: Question[] = normalizeQuestions(rawQuestions, {
  testId: 'bfi',
  type: 'SINGLE_CHOICE',
  required: true
})

export const bfiOptions = [
  { label: "کاملاً مخالفم", value: "1" },
  { label: "مخالفم", value: "2" },
  { label: "نظری ندارم", value: "3" },
  { label: "موافقم", value: "4" },
  { label: "کاملاً موافقم", value: "5" }
]

export const getBfiInterpretation = (scores: { [key: string]: number }): string => {
  const interpretations: { [key: string]: { [key: string]: string } } = {
    "Openness": {
      "low": "شما فردی محافظه‌کار و سنتی هستید که تغییرات را به سختی می‌پذیرید.",
      "medium": "شما تعادل مناسبی بین سنت و نوآوری دارید.",
      "high": "شما فردی خلاق، کنجکاو و پذیرای تجربه‌های جدید هستید."
    },
    "Conscientiousness": {
      "low": "شما فردی انعطاف‌پذیر و خودجوش هستید که برنامه‌ریزی دقیق را ترجیح نمی‌دهید.",
      "medium": "شما تعادل مناسبی بین نظم و انعطاف‌پذیری دارید.",
      "high": "شما فردی منظم، مسئولیت‌پذیر و هدف‌مند هستید."
    },
    "Extraversion": {
      "low": "شما فردی درون‌گرا هستید که از تنهایی و محیط‌های آرام لذت می‌برید.",
      "medium": "شما تعادل مناسبی بین اجتماعی بودن و درون‌گرایی دارید.",
      "high": "شما فردی برون‌گرا، اجتماعی و پرانرژی هستید."
    },
    "Agreeableness": {
      "low": "شما فردی مستقل و رقابتی هستید که اولویت خود را بر دیگران می‌گذارید.",
      "medium": "شما تعادل مناسبی بین همکاری و استقلال دارید.",
      "high": "شما فردی مهربان، دلسوز و همکاری‌کننده هستید."
    },
    "Neuroticism": {
      "low": "شما فردی آرام، متعادل و مقاوم در برابر استرس هستید.",
      "medium": "شما تعادل مناسبی بین آرامش و حساسیت دارید.",
      "high": "شما فردی حساس و مستعد اضطراب و نگرانی هستید."
    }
  }

  let result = "نتایج تست شخصیت BFI شما:\n\n"
  
  Object.keys(scores).forEach(factor => {
    const score = scores[factor]
    let level = "medium"
    if (score <= 2) level = "low"
    else if (score >= 4) level = "high"
    
    result += `${factor}: ${interpretations[factor][level]}\n\n`
  })
  
  return result
}

export const calculateBfiScores = (answers: string[]): { [key: string]: number } => {
  const scores = {
    "Openness": 0,
    "Conscientiousness": 0, 
    "Extraversion": 0,
    "Agreeableness": 0,
    "Neuroticism": 0
  }
  
  // محاسبه امتیازات بر اساس پاسخ‌ها
  answers.forEach((answer, index) => {
    const score = parseInt(answer)
    
    // سوالات مربوط به هر عامل
    if (index === 3 || index === 8 || index === 13 || index === 18 || index === 23 || 
        index === 28 || index === 33 || index === 38 || index === 43) {
      scores["Openness"] += score
    } else if (index === 1 || index === 6 || index === 11 || index === 16 || index === 21 || 
               index === 26 || index === 31 || index === 36 || index === 41) {
      scores["Conscientiousness"] += score
    } else if (index === 0 || index === 5 || index === 10 || index === 15 || index === 20 || 
               index === 25 || index === 30 || index === 35 || index === 40) {
      scores["Extraversion"] += score
    } else if (index === 4 || index === 9 || index === 14 || index === 19 || index === 24 || 
               index === 29 || index === 34 || index === 39 || index === 44) {
      scores["Agreeableness"] += score
    } else if (index === 2 || index === 7 || index === 12 || index === 17 || index === 22 || 
               index === 27 || index === 32 || index === 37 || index === 42) {
      scores["Neuroticism"] += score
    }
  })
  
  // محاسبه میانگین
  Object.keys(scores).forEach(key => {
    scores[key as keyof typeof scores] = scores[key as keyof typeof scores] / 9
  })
  
  return scores
}

export default bfiQuestions


