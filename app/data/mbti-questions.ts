import { Question } from '@/types/test'
import { normalizeQuestions } from '@/lib/helpers/question-helper'

// فقط فیلدهای خام هر سؤال
type RawQuestion = Pick<Question, 'text' | 'options'>


const rawQuestions: RawQuestion[] = [
  {
    text: "در مهمانی‌ها، معمولاً:",
    options: [
      "با افراد جدید آشنا می‌شوید",
      "با دوستان قدیمی وقت می‌گذرانید",
      "در گوشه‌ای آرام می‌نشینید",
      "میزبان را در سازماندهی کمک می‌کنید"
    ]
  },
  {
    text: "کدام یک را ترجیح می‌دهید؟",
    options: [
      "اطلاعات جدید و نوآورانه",
      "اطلاعات ثابت و قابل اعتماد",
      "ترکیبی از هر دو",
      "بستگی به موقعیت دارد"
    ]
  },
  {
    text: "وقتی تصمیم می‌گیرید، بیشتر:",
    options: [
      "از منطق و تحلیل استفاده می‌کنید",
      "از احساسات و ارزش‌ها استفاده می‌کنید",
      "از تجربه‌های گذشته استفاده می‌کنید",
      "از مشورت با دیگران استفاده می‌کنید"
    ]
  },
  {
    text: "در کار، ترجیح می‌دهید:",
    options: [
      "کارهای جدید و متنوع",
      "کارهای آشنا و قابل پیش‌بینی",
      "کارهای چالش‌برانگیز",
      "کارهای تیمی"
    ]
  },
  {
    text: "وقتی با مشکل مواجه می‌شوید:",
    options: [
      "سریع تصمیم می‌گیرید",
      "مدت زمان بیشتری فکر می‌کنید",
      "از دیگران کمک می‌خواهید",
      "مشکل را به تعویق می‌اندازید"
    ]
  },
  {
    text: "در روابط، بیشتر:",
    options: [
      "مستقل عمل می‌کنید",
      "با دیگران همکاری می‌کنید",
      "رهبری را به عهده می‌گیرید",
      "پیروی می‌کنید"
    ]
  },
  {
    text: "کدام یک را ترجیح می‌دهید؟",
    options: [
      "جزئیات دقیق",
      "تصویر کلی",
      "ترکیبی از هر دو",
      "بستگی به موضوع دارد"
    ]
  },
  {
    text: "وقتی برنامه‌ریزی می‌کنید:",
    options: [
      "برنامه‌های دقیق و منظم",
      "برنامه‌های انعطاف‌پذیر",
      "برنامه‌های کوتاه‌مدت",
      "برنامه‌های بلندمدت"
    ]
  },
  {
    text: "در بحث‌ها، معمولاً:",
    options: [
      "مستقیماً نظر خود را می‌گویید",
      "با احتیاط نظر خود را بیان می‌کنید",
      "به نظرات دیگران گوش می‌دهید",
      "سعی می‌کنید توافق ایجاد کنید"
    ]
  },
  {
    text: "وقتی انرژی می‌گیرید:",
    options: [
      "از بودن با دیگران",
      "از تنهایی و تفکر",
      "از فعالیت‌های فیزیکی",
      "از فعالیت‌های ذهنی"
    ]
  },
  {
    text: "کدام یک را ترجیح می‌دهید؟",
    options: [
      "امکانات و احتمالات",
      "واقعیت‌ها و حقایق",
      "ترکیبی از هر دو",
      "بستگی به موقعیت دارد"
    ]
  },
  {
    text: "وقتی کار می‌کنید:",
    options: [
      "با دیگران همکاری می‌کنید",
      "به تنهایی کار می‌کنید",
      "در تیم‌های کوچک کار می‌کنید",
      "در تیم‌های بزرگ کار می‌کنید"
    ]
  },
  {
    text: "در تصمیم‌گیری:",
    options: [
      "از منطق و تحلیل استفاده می‌کنید",
      "از احساسات و ارزش‌ها استفاده می‌کنید",
      "از تجربه‌های گذشته استفاده می‌کنید",
      "از مشورت با دیگران استفاده می‌کنید"
    ]
  },
  {
    text: "وقتی یاد می‌گیرید:",
    options: [
      "از تجربه و عمل",
      "از مطالعه و نظریه",
      "از مشاهده و تقلید",
      "از بحث و گفتگو"
    ]
  },
  {
    text: "در روابط:",
    options: [
      "مستقل عمل می‌کنید",
      "با دیگران همکاری می‌کنید",
      "رهبری را به عهده می‌گیرید",
      "پیروی می‌کنید"
    ]
  },
  {
    text: "وقتی برنامه‌ریزی می‌کنید:",
    options: [
      "برنامه‌های دقیق و منظم",
      "برنامه‌های انعطاف‌پذیر",
      "برنامه‌های کوتاه‌مدت",
      "برنامه‌های بلندمدت"
    ]
  },
  {
    text: "در بحث‌ها:",
    options: [
      "مستقیماً نظر خود را می‌گویید",
      "با احتیاط نظر خود را بیان می‌کنید",
      "به نظرات دیگران گوش می‌دهید",
      "سعی می‌کنید توافق ایجاد کنید"
    ]
  },
  {
    text: "وقتی انرژی می‌گیرید:",
    options: [
      "از بودن با دیگران",
      "از تنهایی و تفکر",
      "از فعالیت‌های فیزیکی",
      "از فعالیت‌های ذهنی"
    ]
  },
  {
    text: "کدام یک را ترجیح می‌دهید؟",
    options: [
      "امکانات و احتمالات",
      "واقعیت‌ها و حقایق",
      "ترکیبی از هر دو",
      "بستگی به موقعیت دارد"
    ]
  },
  {
    text: "وقتی کار می‌کنید:",
    options: [
      "با دیگران همکاری می‌کنید",
      "به تنهایی کار می‌کنید",
      "در تیم‌های کوچک کار می‌کنید",
      "در تیم‌های بزرگ کار می‌کنید"
    ]
  },
  {
    text: "در تصمیم‌گیری:",
    options: [
      "از منطق و تحلیل استفاده می‌کنید",
      "از احساسات و ارزش‌ها استفاده می‌کنید",
      "از تجربه‌های گذشته استفاده می‌کنید",
      "از مشورت با دیگران استفاده می‌کنید"
    ]
  },
  {
    text: "وقتی یاد می‌گیرید:",
    options: [
      "از تجربه و عمل",
      "از مطالعه و نظریه",
      "از مشاهده و تقلید",
      "از بحث و گفتگو"
    ]
  },
  {
    text: "در روابط:",
    options: [
      "مستقل عمل می‌کنید",
      "با دیگران همکاری می‌کنید",
      "رهبری را به عهده می‌گیرید",
      "پیروی می‌کنید"
    ]
  },
  {
    text: "وقتی برنامه‌ریزی می‌کنید:",
    options: [
      "برنامه‌های دقیق و منظم",
      "برنامه‌های انعطاف‌پذیر",
      "برنامه‌های کوتاه‌مدت",
      "برنامه‌های بلندمدت"
    ]
  },
  {
    text: "در بحث‌ها:",
    options: [
      "مستقیماً نظر خود را می‌گویید",
      "با احتیاط نظر خود را بیان می‌کنید",
      "به نظرات دیگران گوش می‌دهید",
      "سعی می‌کنید توافق ایجاد کنید"
    ]
  },
  {
    text: "وقتی انرژی می‌گیرید:",
    options: [
      "از بودن با دیگران",
      "از تنهایی و تفکر",
      "از فعالیت‌های فیزیکی",
      "از فعالیت‌های ذهنی"
    ]
  },
  {
    text: "کدام یک را ترجیح می‌دهید؟",
    options: [
      "امکانات و احتمالات",
      "واقعیت‌ها و حقایق",
      "ترکیبی از هر دو",
      "بستگی به موقعیت دارد"
    ]
  },
  {
    text: "وقتی کار می‌کنید:",
    options: [
      "با دیگران همکاری می‌کنید",
      "به تنهایی کار می‌کنید",
      "در تیم‌های کوچک کار می‌کنید",
      "در تیم‌های بزرگ کار می‌کنید"
    ]
  },
  {
    text: "در تصمیم‌گیری:",
    options: [
      "از منطق و تحلیل استفاده می‌کنید",
      "از احساسات و ارزش‌ها استفاده می‌کنید",
      "از تجربه‌های گذشته استفاده می‌کنید",
      "از مشورت با دیگران استفاده می‌کنید"
    ]
  },
  {
    text: "وقتی یاد می‌گیرید:",
    options: [
      "از تجربه و عمل",
      "از مطالعه و نظریه",
      "از مشاهده و تقلید",
      "از بحث و گفتگو"
    ]
  }
]



// خروجی نهایی با فیلدهای اجباری تکمیل می‌شود
export const mbtiQuestions: Question[] = normalizeQuestions(rawQuestions, {
  testId: 'mbti',
  type: 'SINGLE_CHOICE',
  required: true
})

export const mbtiOptions = [
  { label: "گزینه اول", value: "A" },
  { label: "گزینه دوم", value: "B" },
  { label: "گزینه سوم", value: "C" },
  { label: "گزینه چهارم", value: "D" }
]

export const getMbtiInterpretation = (type: string): string => {
  const types: Record<string, string> = {
    "INTJ": "معمار - شما فردی مستقل، خلاق و استراتژیک هستید. از تفکر عمیق و برنامه‌ریزی بلندمدت لذت می‌برید.",
    "INTP": "متفکر - شما فردی منطقی، کنجکاو و مستقل هستید. از حل مسائل پیچیده و کشف حقایق لذت می‌برید.",
    "ENTJ": "فرمانده - شما فردی رهبر، مصمم و استراتژیک هستید. از هدایت تیم‌ها و دستیابی به اهداف لذت می‌برید.",
    "ENTP": "مجادله‌گر - شما فردی خلاق، کنجکاو و انعطاف‌پذیر هستید. از بحث‌های فکری و ایده‌های جدید لذت می‌برید.",
    "INFJ": "مدافع - شما فردی خلاق، مصمم و الهام‌بخش هستید. از کمک به دیگران و ایجاد تغییرات مثبت لذت می‌برید.",
    "INFP": "میانجی - شما فردی خلاق، کنجکاو و انعطاف‌پذیر هستید. از ارزش‌های شخصی و کمک به دیگران لذت می‌برید.",
    "ENFJ": "قهرمان - شما فردی خلاق، مصمم و الهام‌بخش هستید. از رهبری و کمک به دیگران لذت می‌برید.",
    "ENFP": "مبارز - شما فردی خلاق، کنجکاو و انعطاف‌پذیر هستید. از ایده‌های جدید و ارتباط با دیگران لذت می‌برید.",
    "ISTJ": "منطقی - شما فردی عملی، واقع‌بین و قابل اعتماد هستید. از نظم و ساختار لذت می‌برید.",
    "ISFJ": "مدافع - شما فردی خلاق، مصمم و الهام‌بخش هستید. از کمک به دیگران و حفظ سنت‌ها لذت می‌برید.",
    "ESTJ": "اجرایی - شما فردی عملی، واقع‌بین و قابل اعتماد هستید. از مدیریت و سازماندهی لذت می‌برید.",
    "ESFJ": "قنصل - شما فردی خلاق، مصمم و الهام‌بخش هستید. از کمک به دیگران و ایجاد هماهنگی لذت می‌برید.",
    "ISTP": "ماهر - شما فردی عملی، واقع‌بین و قابل اعتماد هستید. از حل مسائل عملی و کار با دست‌ها لذت می‌برید.",
    "ISFP": "ماجراجو - شما فردی خلاق، کنجکاو و انعطاف‌پذیر هستید. از هنر و زیبایی لذت می‌برید.",
    "ESTP": "کارآفرین - شما فردی عملی، واقع‌بین و قابل اعتماد هستید. از فعالیت و ماجراجویی لذت می‌برید.",
    "ESFP": "سرگرم‌کننده - شما فردی خلاق، کنجکاو و انعطاف‌پذیر هستید. از سرگرمی و ارتباط با دیگران لذت می‌برید."
  }
  
  return types[type] || "نوع شخصیت شما مشخص نشده است."
}

export const getMbtiType = (answers: string[]): string => {
  let E = 0, I = 0, S = 0, N = 0, T = 0, F = 0, J = 0, P = 0
  
  // محاسبه امتیازات بر اساس پاسخ‌ها
  answers.forEach((answer, index) => {
    if (index % 4 === 0) { // سوالات E/I
      if (answer === "A" || answer === "C") E++
      else I++
    } else if (index % 4 === 1) { // سوالات S/N
      if (answer === "A" || answer === "C") S++
      else N++
    } else if (index % 4 === 2) { // سوالات T/F
      if (answer === "A" || answer === "C") T++
      else F++
    } else { // سوالات J/P
      if (answer === "A" || answer === "C") J++
      else P++
    }
  })
  
  const type = 
    (E > I ? "E" : "I") +
    (S > N ? "S" : "N") +
    (T > F ? "T" : "F") +
    (J > P ? "J" : "P")
  
  return type
}

export default mbtiQuestions
